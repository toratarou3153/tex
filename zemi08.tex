\documentclass[12pt]{jarticle}
\usepackage{a4wide}
\usepackage{amsmath}%数学記号
\usepackage{amssymb}%数学記号
\usepackage{epsfig}%図
\usepackage{latexsym}
\usepackage{supertabular}
\usepackage{graphicx}
\usepackage{color}
\usepackage{ascmac}
\usepackage{multicol}
\usepackage{ascmac}
\usepackage{systeme}
\usepackage{amsmath,cases}
\pagestyle{plain}

\newtheorem{theorem}{定理}[section]
\newtheorem{lemma}[theorem]{補題}
\newtheorem{proposition}[theorem]{命題}
\newtheorem{conjecture}[theorem]{予想}
\newtheorem{corollary}[theorem]{系}
\newtheorem{definition}[theorem]{定義}
\newtheorem{example}[theorem]{例}
\newtheorem{exercise}[theorem]{例題}
\newtheorem{problem}[theorem]{問}
\newtheorem{algorithm}[theorem]{アルゴリズム}
\newtheorem{remark}[theorem]{注意}

\def\qed{{\hfill$\square$}}
\def\proof{{\vspace{-0.3cm}f 証明: \,}}
\def\solution{{\vspace{-0.3cm}f 解: \,}}
\def\N{{\Bbb N}}
\def\Z{{\Bbb Z}}
\def\Q{{\Bbb Q}}
\def\R{{\Bbb R}}
\def\C{{\Bbb C}}
\def\F{{\Bbb F}}
\def\D{{\mathcal D}}
\def\mod{{\mathrm{mod\,\,}}}
\def\GL{{\mathrm{GL}}}
\def\GF{{\mathrm{GF}}}
\def\H{{\mathcal{H}}}

\setlength{\textwidth}{170mm}
\setlength{\textheight}{240mm}
\setlength{\oddsidemargin}{-5mm}
\setlength{\evensidemargin}{-5mm}
\setlength{\topmargin}{-10mm}
\setlength{\headheight}{0mm}
\setlength{\headsep}{10mm}

\title{項目反応理論}
\begin{document}
\maketitle
\setcounter{section}{2}

\section{尺度地の推定}
\setcounter{subsection}{2}
\subsection{数値解法}
\setcounter{subsubsection}{1}
\subsubsection{挟み撃ち法}
前回は方程式を解く解析的解法を紹介した。しかし、解析的に解くことが困難な場合には、関数の具体的な形状に依存しない解法が求められる。数値解法の$1$種である挟み撃ち法を紹介する。以下のアルゴリズムで方程式を解く。
\begin{itemize}
  \item[(1)] 正の値をとる収束精度$\displaystyle\epsilon$を定める。
  \item[(2)] $LL^{\prime}(\theta_D) > 0$なる下限値$\displaystyle\theta_D$を定める。
  \item[(3)] $LL^{\prime}(\theta_D) < 0$なる上限値$\displaystyle\theta_U$を定める。
  \item[(4)] $\displaystyle \theta_M = \frac{(\theta_D + \theta_U )}{2}$
  \item[(5)] $\displaystyle LL^{\prime}(\theta_M) > \epsilon$なら$\displaystyle\theta_D=\theta_M$として$(4)$に戻る。
  \item[(6)]  $\displaystyle LL^{\prime}(\theta_M) < -\epsilon$なら$\displaystyle\theta_U=\theta_M$として$(4)$に戻る。
  \item[(7)] $\displaystyle |LL^{\prime}(\theta_M)| \leq \epsilon$なら尺度地の推定値$\hat{\theta}_i = \theta_M$として計算終了。
\end{itemize}
[具体例]
\begin{itemize}
  \item[1.] (1)収束精度を$\displaystyle\epsilon = 0.00001$と定める。
  \item[2.] (2)$LL^{\prime}(-20.0) = 1.64388$で正になる下限値$\displaystyle\theta_D = -20.0$を定める。
  \item[3.] (3)$LL^{\prime}(10.0) = -1.50686$なる上限値$\displaystyle\theta_U$を定める。
  \item[4.] (4)$\displaystyle \frac{-20.0 + 10.0}{2} = -5.0$
  \item[5.] (5)$\displaystyle LL^{\prime}(-5.0) = 1.39742$なので$\displaystyle\theta_D=\theta_M$として$(4)$に戻る。
  \item[6.]  (4)$\displaystyle \frac{(-5.0 + 10.0)}{2} = 2.5$
  \item[7.] (5)$\displaystyle LL^{\prime}(2.5) = -0.34504$なので$\displaystyle\theta_U=\theta_M$として$(4)$に戻る。
  \item[8.] $\cdots$$\cdots$
  \item[9.] (3)  $\displaystyle \frac{(-1.8087 + (-1.8085))}{2} = -1.80859$
  \item[10.] (7) $\displaystyle |LL^{\prime}(-1.80859)| \leq 0.00001$なので、$\hat{\theta}_i = -1.80859$で計算終了。
\end{itemize}
\subsubsection{ニュートン法}
前述した挟み撃ち法は、正と負の値である$\theta_U$と$\theta_D$の間には$0$となる値が存在する、ある種の中間値の定理のような性質を利用している。関数の具体的な形状に依存せず方程式を解く方法に、ニュートン法を紹介する。これは、初期値を更新しながら解に近づく方法である。

ニュートン法は、区分を狭めれば滑らかな関数は直線に近づいていく、という性質を利用した数値解法である。まず、初期値$_{0}\theta$を設ける。関数に対して$_{0}\theta$から接線を引く。初めのほうは関数も直線ではないため解には遠いものとなるが、次に初めの接線と$0$の交点を$_{1}\theta$とする。これを繰り返すことで、限りなく解に近似することができる。では、どのようにして$_{0}\theta$から$_{1}\theta$を求めることができるのだろうか。

$_{0}\theta$から引いた接線の傾きは
\begin{align}
  \label{00}
  \displaystyle LL^{\prime\prime}(_{0}\theta) = \frac{LL^{\prime}(_{0}\theta)}{_{0}\theta - _{1}\theta} \tag{3.17}
\end{align}
のように表現することができる。この式を$_{1}\theta$に関して解くと、
\begin{align}
  \label{01}
  \displaystyle _{1}\theta = _{0}\theta - \frac{LL^{\prime}(_{0}\theta)}{LL^{\prime\prime}(_{0}\theta)} \tag{3.18}
\end{align}
となり$_{0}\theta$から$_{1}\theta$を求めることができる。$_{2}\theta$を求められることから、一般化して
\begin{align}
  \label{02}
  \displaystyle _{k+1}\theta = _{k}\theta - \frac{LL^{\prime}(_{k}\theta)}{LL^{\prime\prime}(_{k}\theta)} \tag{3.19}
\end{align}
と表すことができる。



\end{document}
